# qoq

## Сетап

1. Встановити докер на сервер
2. Скопіювати на сервер файли (dist, Dockerfile, compose.yaml, ssl-setup)
3. Зроби скрипт виконуваним: `chmod +x ssl-setup.sh`.
4. Запустити скрипт `chmod +x ssl-setup.sh`.
5. Після того як скрипт відпрацював, він виведе підказку як додати крону для автоматичного онволення сертифікату (час для крони можна налаштовувати за побажанням)

## Пояснення 

- Dockerfile збирає `nginx` образ для статичних файлів з директорії `dist`
- Compose використоує зібраний образ + certbot для сертифікації.
- Скрипт `ssl-setup.sh` виконує всю роботу для сетапу автоматично.

Якщо будуть проблеми з файлом, може допомогит команда `sed -i 's/\r$//' ssl-setup.sh` яка прибере символи кіня рядків вінди 

### ssl-setup.sh   

Скрипт спочатку створює тимчасовий nginx-конфіг, який працює тільки по HTTP,
щоб certbot міг підтвердити домен. Потім він запускає nginx, чекає кілька секунд
і викликає certbot для отримання SSL-сертифіката. 

Якщо сертифікат успішно видано, скрипт генерує новий nginx-конфіг з HTTPS, підключаючи
отримані сертифікати, і перезапускає nginx уже з шифрованим трафіком. 

Далі створюється допоміжний скрипт renew-certs.sh, який оновлює сертифікати і перезапускає nginx 
у разі успішного поновлення. Наприкінці користувачу пропонується додати 
цей скрипт у cron, щоб поновлення відбувалося автоматично.

